<html>
<head>
	<meta id="view-meta" name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">	
	<title>Overview | inmedia</title>
<link rel="stylesheet" type="text/css" href="css/styles.css"/>
</head>
<body>
	<div id="page-frame">
		<div id="site-header">
			<h1>inmedia</h1>
			<div class="header-links">
				<span class="link-wrapper-span">
				
					
						<a href="index.html">Home</a>
					

				
					
						<a class="active-head-link" href="overview.html">Overview</a>
					

				
					
						<a href="api.html">API</a>
					

				
					
						<a href="spec.html">Specs</a>
					

				
				</span>
			</div>
		</div>
		<div id="body-frame">
			
				<h2>Overview</h2>
			
			<div class="basic-content-frame">
<p><strong>inmedia</strong> allows for routes based on any number of pipeline elements, so Connect&#39;s <code>(req, res, next)</code> signature can be replaced by <code>(justOne, next)</code> or <code>(oneFish, twoFish, redFish, blueFish, next)</code>.  This flexibility can be locked down with optional arity enforcement, specified with an <code>enforceArity</code> property on the options object passed in at construction.</p>
<pre><code class="lang-javascript"><span class="keyword">var</span> inmedia <span class="keyword operator">=</span> <span class="function call">require</span>(<span class="string">"inmedia"</span>);
<span class="keyword">var</span> _ <span class="keyword operator">=</span> <span class="function call">require</span>(<span class="string">"underscore"</span>);

<span class="storage">var</span> <span class="entity function">midware</span> <span class="keyword operator">=</span> <span class="keyword">function</span>(one, two, three, four, next) {
    one.val <span class="keyword operator">+</span><span class="keyword operator">=</span> <span class="constant numeric">1</span>;
    two.val <span class="keyword operator">+</span><span class="keyword operator">=</span> <span class="constant numeric">2</span>;
    three.val <span class="keyword operator">+</span><span class="keyword operator">=</span> <span class="constant numeric">3</span>;
    four.val <span class="keyword operator">+</span><span class="keyword operator">=</span> <span class="constant numeric">4</span>;
    <span class="function call">next</span>();
}
<span class="keyword">var</span> router <span class="keyword operator">=</span> <span class="function call">inmedia</span>();
router.<span class="function call">useMiddleware</span>(midware);
<span class="storage">var</span> <span class="entity function">always</span> <span class="keyword operator">=</span> <span class="keyword">function</span>() { <span class="keyword">return</span> <span class="constant language">true</span>; }


router.<span class="function call">useRoute</span>(always, <span class="keyword">function</span>(one, two, three, four) {
    <span class="keyword">var</span> current <span class="keyword operator">=</span> <span class="constant numeric">1</span>;
    _.<span class="function call">each</span>( [one, two, three, four], <span class="keyword">function</span>(oneVal) {
        console.<span class="support method">log</span>(current <span class="keyword operator">+</span> <span class="string">": "</span> <span class="keyword operator">+</span> oneVal.val);
        current<span class="keyword operator">+</span><span class="keyword operator">+</span>;
    });
})
router.<span class="function call">handle</span>({val: <span class="constant numeric">10</span>}, {val: <span class="constant numeric">20</span>}, {val: <span class="constant numeric">30</span>}, {val: <span class="constant numeric">40</span>});

<span class="comment">// output: </span>
<span class="comment">// 1: 11</span>
<span class="comment">// 2: 22</span>
<span class="comment">// 3: 33</span>
<span class="comment">// 4: 44</span></code></pre>
<h4 id="routing">Routing</h4>
<p>Routing is based on predicate functions instead of strings, enabling a much wider variety of use cases:</p>
<pre><code class="lang-javascript"><span class="keyword">var</span> inmedia <span class="keyword operator">=</span> require <span class="string">"inmedia"</span>;
<span class="keyword">var</span> router <span class="keyword operator">=</span> <span class="function call">inmedia</span>();

<span class="storage">var</span> <span class="entity function">isEven</span> <span class="keyword operator">=</span> <span class="keyword">function</span>(num) {
    <span class="keyword">if</span> (num % <span class="constant numeric">2</span>) <span class="keyword">return</span> <span class="constant language">false</span>;
    <span class="keyword">return</span> <span class="constant language">true</span>;
}
<span class="storage">var</span> <span class="entity function">isOdd</span> <span class="keyword operator">=</span> <span class="keyword">function</span>(num) {
    <span class="keyword">if</span> (num % <span class="constant numeric">2</span>) <span class="keyword">return</span> <span class="constant language">true</span>;
    <span class="keyword">return</span> <span class="constant language">false</span>;
}
<span class="storage">var</span> <span class="entity function">oddRoute</span> <span class="keyword operator">=</span> <span class="keyword">function</span>(dataObj) {
    console.<span class="support method">log</span>(<span class="string">"ODD: "</span> <span class="keyword operator">+</span> dataObj.val);
}
<span class="storage">var</span> <span class="entity function">evenRoute</span> <span class="keyword operator">=</span> <span class="keyword">function</span>(dataObj) {
    console.<span class="support method">log</span>(<span class="string">"EVEN: "</span> <span class="keyword operator">+</span> dataObj.val);
}

router.<span class="function call">useRoute</span>(isEven, evenRoute);
router.<span class="function call">useRoute</span>(isOdd, oddRoute);
router.<span class="function call">handle</span>({val: <span class="constant numeric">9</span>});
router.<span class="function call">handle</span>({val: <span class="constant numeric">15</span>});
router.<span class="function call">handle</span>({val: <span class="constant numeric">10</span>});

<span class="comment">// output:</span>
<span class="comment">// ODD: 9</span>
<span class="comment">// ODD: 15</span>
<span class="comment">// EVEN: 10</span></code></pre>
<p>It&#39;s simple to implement string-based routing on top of the predicate system.  A basic version for URI-based routing: </p>
<pre><code class="lang-javascript"><span class="storage">var</span> <span class="entity function">uriStringToPred</span> <span class="keyword operator">=</span> <span class="keyword">function</span>(uri) {
    <span class="keyword">return</span> <span class="keyword">function</span>(page) {
        <span class="keyword">if</span> (page.uri <span class="keyword operator">=</span><span class="keyword operator">=</span><span class="keyword operator">=</span> uri) <span class="keyword">return</span> <span class="constant language">true</span>;
        <span class="keyword">return</span> <span class="constant language">false</span>;
    }
}
router.<span class="function call">useRoute</span>(<span class="function call">uriStringToPred</span>(<span class="string">"/some/route"</span>), routeHandler);</code></pre>
<h4 id="simple-examples">Simple Examples</h4>
<p><strong>inmedia</strong> can be used as a pipeline for event handling, or for any process involving data filtration and/or manipulation.</p>
<h5 id="filtering-with-middleware-">Filtering with Middleware:</h5>
<pre><code class="lang-javascript"><span class="storage">var</span> <span class="entity function">onlySmiths</span> <span class="keyword operator">=</span> <span class="keyword">function</span>(person, next) {
    <span class="keyword">if</span> (person.lastName <span class="keyword operator">=</span><span class="keyword operator">=</span><span class="keyword operator">=</span> <span class="string">"Smith"</span>) {
        <span class="function call">next</span>();
    }
    <span class="comment">// else do nothing, and</span>
    <span class="comment">// element falls out of pipeline</span>
}

<span class="storage">var</span> <span class="entity function">printPerson</span> <span class="keyword operator">=</span> <span class="keyword">function</span>(person) {
    console.<span class="support method">log</span>(<span class="string">"first: "</span> <span class="keyword operator">+</span> person.first 
                <span class="keyword operator">+</span> <span class="string">"  last: "</span> <span class="keyword operator">+</span> person.last );
}

<span class="keyword">var</span> router <span class="keyword operator">=</span> <span class="function call">inmedia</span>();
router.<span class="function call">useMiddleware</span>(onlySmiths);
router.<span class="function call">useRoute</span>(always, printPerson);
router.<span class="function call">handle</span>({firstName: <span class="string">"John"</span>, lastName: <span class="string">"Smith"</span>});
router.<span class="function call">handle</span>({firstName: <span class="string">"Colonel"</span>, lastName: <span class="string">"Mustard"</span>})
router.<span class="function call">handle</span>({firstName: <span class="string">"Nikola"</span>, lastName: <span class="string">"Tesla"</span>});
router.<span class="function call">handle</span>({firstName: <span class="string">"Mary"</span>, lastName: <span class="string">"Smith"</span>});


<span class="comment">// output:</span>
<span class="comment">// "first: John  last: Smith"</span>
<span class="comment">// "first: Mary  last: Smith"</span></code></pre>
<h5 id="sorting-with-routes-">Sorting with Routes:</h5>
<pre><code class="lang-javascript">
<span class="storage">var</span> <span class="entity function">is18OrOver</span> <span class="keyword operator">=</span> <span class="keyword">function</span>(person) {
    <span class="keyword">if</span> (person.age <span class="keyword operator">&gt;</span><span class="keyword operator">=</span> <span class="constant numeric">18</span>) <span class="keyword">return</span> <span class="constant language">true</span>;
    <span class="keyword">return</span> <span class="constant language">false</span>;
}
<span class="storage">var</span> <span class="entity function">isUnder18</span> <span class="keyword operator">=</span> <span class="keyword">function</span>(person) {
    <span class="keyword">if</span> (person.age <span class="keyword operator">&lt;</span> <span class="constant numeric">18</span>) <span class="keyword">return</span> <span class="constant language">true</span>;
    <span class="keyword">return</span> <span class="constant language">false</span>
} 

<span class="keyword">var</span> router <span class="keyword operator">=</span> <span class="function call">inmedia</span>();
<span class="storage">var</span> <span class="entity function">childRoute</span> <span class="keyword operator">=</span> <span class="keyword">function</span>(person) {
    console.<span class="support method">log</span>(<span class="string">"CHILD: "</span> <span class="keyword operator">+</span> person.name);
}
<span class="storage">var</span> <span class="entity function">adultRoute</span> <span class="keyword operator">=</span> <span class="keyword">function</span>(person) {
    console.<span class="support method">log</span>(<span class="string">"ADULT: "</span> <span class="keyword operator">+</span> person.name);
}
router.<span class="function call">use</span>(is18OrOver, adultRoute);
router.<span class="function call">use</span>(isUnder18, childRoute);

router.<span class="function call">handle</span>({name: <span class="string">"Billy Bob"</span>, age: <span class="constant numeric">47</span>});
router.<span class="function call">handle</span>({name: <span class="string">"Mary-Beth Anne Peters Washington"</span>, age: <span class="constant numeric">28</span>});
router.<span class="function call">handle</span>({name: <span class="string">"Little Jimmy"</span>, age: <span class="constant numeric">8</span>});

<span class="comment">// output:</span>
<span class="comment">// "ADULT: Billy Bob"</span>
<span class="comment">// "ADULT: Mary-Beth Anne Peters Washington"</span>
<span class="comment">// "CHILD: Little Jimmy"</span></code></pre>
<h5 id="data-manipulation-or-augmentation-">Data Manipulation or Augmentation:</h5>
<pre><code class="lang-javascript"><span class="keyword">var</span> request <span class="keyword operator">=</span> <span class="function call">require</span>(<span class="string">"request"</span>);
<span class="keyword">var</span> inmedia <span class="keyword operator">=</span> <span class="function call">require</span>(<span class="string">"inmedia"</span>);

<span class="storage">var</span> <span class="entity function">dogMiddleware</span> <span class="keyword operator">=</span> <span class="keyword">function</span>(dog, next) {
    dog.ageInHumanYears <span class="keyword operator">=</span> dog.age <span class="keyword operator">*</span> <span class="constant numeric">7</span>;
    <span class="function call">next</span>()
}

<span class="keyword">var</span> router <span class="keyword operator">=</span> <span class="function call">inmedia</span>();
router.<span class="function call">useMiddleware</span>(dogMiddleware);

<span class="storage">var</span> <span class="entity function">always</span> <span class="keyword operator">=</span> <span class="keyword">function</span>() { <span class="keyword">return</span> <span class="constant language">true</span>; }
router.<span class="function call">useRoute</span>(always, <span class="keyword">function</span>(dog) {
    <span class="keyword">var</span> message <span class="keyword operator">=</span> dog.name <span class="keyword operator">+</span> <span class="string">" is "</span> <span class="keyword operator">+</span> dog.ageInHumanYears <span class="keyword operator">+</span> <span class="string">" in human years."</span>;
    console.<span class="support method">log</span>(message);
});

router.<span class="function call">handle</span>({name: <span class="string">"Old Yeller"</span>, age: <span class="constant numeric">12</span>});

<span class="comment">//output :</span>
<span class="comment">// "Old Yeller is 84 in human years."</span></code></pre>
<p><a href="./api.html">See the API for more ==&gt;</a></p>
<h2 id="installation">Installation</h2>
<pre><code>npm install inmedia</code></pre>
<h2 id="github">GitHub</h2>
<p><a href="https://github.com/scivey/inmedia">https://github.com/scivey/inmedia</a></p>
<h2 id="contact">Contact</h2>
<p><a href="https://github.com/scivey">https://github.com/scivey</a></p>
<p><a href="http://www.scivey.net">http://www.scivey.net</a></p>
<p>scott.ivey@gmail.com</p>
<h2 id="license">License</h2>
<p>MIT License (MIT)</p>
<p>Copyright (c) 2013 Scott Ivey, <a href="&#x6d;&#x61;&#105;&#x6c;&#x74;&#x6f;&#x3a;&#x73;&#99;&#x6f;&#x74;&#116;&#46;&#105;&#118;&#x65;&#x79;&#x40;&#x67;&#109;&#x61;&#x69;&#108;&#x2e;&#x63;&#x6f;&#109;">&#x73;&#99;&#x6f;&#x74;&#116;&#46;&#105;&#118;&#x65;&#x79;&#x40;&#x67;&#109;&#x61;&#x69;&#108;&#x2e;&#x63;&#x6f;&#109;</a></p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the &quot;Software&quot;), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.</p>

</div>
		</div>
	</div>
</body>
</html>